<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
    <title>NAVER MAP</title>
    <script type="text/javascript" src="http://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=0jzt0obvk5"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
</head>
<body>
<div class="buttons">
    <input id="interaction" type="button" name="지도 인터렉션" value="지도 인터렉션" class="control-btn control-on">
    <input id="kinetic" type="button" name="관성 드래깅" value="관성 드래깅" class="control-btn control-on">
    <input id="tile-transition" type="button" name="타일 fadeIn 효과" value="타일 fadeIn 효과" class="control-btn control-on">
    <input id="controls" type="button" name="모든 지도 컨트롤" value="모든 지도 컨트롤" class="control-btn control-on">
    <input id="min-max-zoom" type="button" name="최소/최대 줌 레벨" value="최소/최대 줌 레벨: 7 ~ 21" class="control-btn">
</div>
<div id="map" style="width:100%; height:600px;"></div>
<div>
    <form th:action="@{/map/upload}" method="post" enctype="multipart/form-data">
        <input th:type="file" th:name="file"/>
        <input th:type="submit" th:value="업로드"/>
    </form>
</div>
<div>
    <p th:each="location : ${locationList}" th:object="${location}">
        <span th:id="name" th:value="*{name}"></span>
        <span th:id="latitude" th:value="*{latitude}"></span>
        <span th:id="longitude" th:value="*{longitude}"></span>
    </p>
</div>

<script th:inline="javascript">
    var isEmpty = function (value) {
        if (value == "" || value == null || value == undefined || (value != null && typeof value == "object" && !Object.keys(value).length)) {
            return true
        } else {
            return false
        }
    };
    // var utmk = naver.maps.TransCoord.fromLatLngToUTMK(latlng); // 위/경도 -> UTMK
    // var tm128 = naver.maps.TransCoord.fromUTMKToTM128(utmk);   // UTMK -> TM128
    // var naverCoord = naver.maps.TransCoord.fromTM128ToNaver(tm128); // TM128 -> NAVER

    // console.log('UTMK: ' + utmk.toString());
    // console.log('TM128: ' + tm128.toString());
    // console.log('NAVER: ' + naverCoord.toString());
</script>

<script th:inline="javascript">
    var mapOptions = {
        // default
        center: new naver.maps.LatLng(37.3595704, 127.105399),
        zoom: 15,
        minZoom: 8,
        zoomControl: true,
        zoomControlOptions: {
            position: naver.maps.Position.TOP_RIGHT
        }
    };

    // dragging
    $("#kinetic").on("click", function(e) {
        e.preventDefault();

        if (map.getOptions("disableKineticPan")) {
            map.setOptions("disableKineticPan", false);
            $(this).addClass("control-on");
        } else {
            map.setOptions("disableKineticPan", true);
            $(this).removeClass("control-on");
        }
    });

    var map = new naver.maps.Map('map', mapOptions);
    map.setOptions("mapTypeControl", true);

    // result of searching similar cafe
    var lat = $('#latitude').attr('value');
    var long = $('#longitude').attr('value');
    var newLocation = new naver.maps.LatLng(lat, long);

    // default
    if (isEmpty(lat) || isEmpty(long)) {
        newLocation = new naver.maps.LatLng(37.3595704, 127.105399);
    }

    map.setCenter(newLocation);

</script>

</body>
</html>